chapter 2
N张输入图像和一个所有图像都可以看到的3D点p,任意一对图像I<sub>i</sub>和I<sub>j</sub>关于点p的图像一致性 表示如下:

![avatar](./mvs_pic/consistency_pic.png)

式中:
p: 3D点;
 πi(p): 点p在图像i中的投影;
Ω(x):点x附近的邻域;
Ii(x): 在区域Ω内的图像强度 
ρ(f, g):两个vector之间的相似性测量;

图像一致性可以通过ρ和Ω的选择来确定.

一些图像一致性不需要邻域Ω一些需要, 邻域的主要作用是确定一块场景的区域是唯一的与场景和视角无关.唯一性和不相关性在图像一致性中经常互斥,邻域越大,图像唯一性的可能就越大,与其它图像的越容易匹配,同时邻域越大,由于变形,深度限制和平滑吉和假设(例如:平面假设)越难维持照明和视口不相关.

MVS算法中, 定义邻域的简单方法是:用一个固定大小的正方形像素网格，当输入图像与正在重建的表面共享大致相同的像素分辨率时这种方法很有效, eg,使用 3x3或者5x5的像素大小, 在更复杂的场景,图像的分辨率不一致,场景位置不是均匀分布的, 调整邻域的大小非常困难, 尺寸需要成比例
相反，图像分辨率和视点分离与场景的距离成正比。 有些方法甚至会改变邻域的形状，其中一个特别成功的实例
视图相关域是通过将域Ω计算为投影以3D点p为中心的3D局部区块 [210, 74],其他方法显着增加图像的密度，
这可以实现更小的域大小，极端情况是使用视频[145]或光场[195,117]

该领域相关的 概念非常相近的是概念是图像一致性聚合[162]，其中包括
在空间上聚合照片一致性测量以增加其鲁棒性。当在没有域的情况下计算的度量一起使用时它是最有效的, 例如 差分平方和Sum of Square Differences (SSD)和 差分绝对值和 Sum of Absolute Differences (SAD)由于先进的聚合技术能在不需要平滑的情况下使用(详见2.1.8).

图像一致性的定义见式2.1, 点的图像一致性可以定义如下,通过对单个图像相关的所有图像对的图像一致性求平均

![avatar](./mvs_pic/consistency_pic.png)

及对所有图相对的图像一致性求平均.

![avatar](./mvs_pic/consistency_pic.png)

如上所述:图像一致性的定义要求所有图像包含给定点,就是说必须已知图像包含给定点.接下来描述一些常用的图像一致性测量方法,详细信息见[99], 通过比较f和g两个vector计算 图像一致性, f,g可以通过采样灰度图的矩形区域来获取如图2-1所示;

![avatar](./mvs_pic/consistency_pic.png)

对于彩色图像,操作如下:
1.计算图像一致性之前将彩色图转为灰度图
2.对rgb通道,每个通道单独计算图像一致性,求平均
3.将,每个通道的vector合并成大的vector

简要说明下对于有无纹理的表面不同的测量方式如图2-2, 图2-3表示随着点沿着对极线移动时的图像一致性曲线,


2.1.1 Normalized Cross Correlation(归一化交叉相关性)
zero-mean NCC 是多视觉立体几何中最常用的一致性测量算法之一, 算法图像增益与偏差无关,并且与材质和光照无关条件下使用例如计算
收集的图像光照和材质相差很多的情况下使用,NCC算法的缺点是缺少表面纹理和重复纹理,计算精度高.计算公式如下

![avatar](./mvs_pic/consistency_pic.png)

f 均值 σ标准差 f

对于彩色图像,将所有颜色简单的集中到一个vector应用上述公式中的效果不佳,在复杂情况下例如均匀纹理表面,主要视觉线索通常是其表面的细微阴影和阴影效果我们想要
NCC捕捉每个颜色通道中细微的空间强度变化，比颜色的强度变化小得多渠道。通过简单的连接，NCC只需要捕获不同颜色通道的强度变化。更好的解决方案
是独立计算每个颜色通道的NCC并返回NCC平均得分。更复杂的方法是计算和单独减去每个颜色通道的平均强度（’f和G’），但将所有颜色通道作为单个向量连接在一起计算其方差时（σf和σg）。这允许NCC捕获
每个颜色通道中的空间强度变化，同时降低权重具有较小强度变化的颜色通道。

2.1.2  Sum of Squared Differences(平方差求和) SSD

2.1.3 Sum of Absolute Differences(差分绝对值)


2.1.4 Census 统计方法

2.1.5 Rank 

2.1.6 Mutual information 互信息

2.1.7 interval comparison间隔对比























chapter 3 基于图像一致性的三维重建